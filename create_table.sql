--@block create agregateds TABLE
create table agregateds (
    geocode ltree not null,
    rmo integer not null,
    hh_sno integer,
    sex integer,
    sex2 integer,
    sex3 integer,
    edu integer,
    edu1 integer,
    edu2 integer,
    edu3 integer,
    edu4 integer,
    edu5 integer,
    edu6 integer,
    edu7 integer,
    edu8 integer,
    edu9 integer,
    edu10 integer,
    edu12 integer,
    edu15 integer,
    edu18 integer,
    occ integer,
    occ2 integer,
    occ3 integer,
    occ4 integer,
    occ5 integer,
    hh_f integer,
    hh_f2 integer,
    hh_a integer,
    hh_a2 integer,
    c01m integer,
    c01f integer,
    c01h integer,
    c02m integer,
    c02f integer,
    c02h integer,
    c03m integer,
    c03f integer,
    c03h integer,
    c04 numeric,
    c05 numeric,
    c06 numeric,
    c07 numeric,
    c08 numeric,
    c09 numeric,
    c10 numeric,
    c11 numeric,
    c12 numeric,
    c13 numeric,
    c14 numeric,
    c15 numeric,
    c16 numeric,
    c17 numeric,
    c18 numeric,
    sf integer,
    mf integer,
    lf integer,
    c19 numeric,
    c20 numeric,
    c21 numeric,
    c22 numeric,
    c23 numeric,
    c24 numeric,
    c25 numeric,
    c26 numeric,
    c27 numeric,
    c28h numeric,
    c28f numeric,
    c29h numeric,
    c29f numeric,
    c30h numeric,
    c30f numeric,
    c31h numeric,
    c31f numeric,
    c32h numeric,
    c32f numeric,
    c33h numeric,
    c33f numeric,
    c34h numeric,
    c34f numeric,
    c35h numeric,
    c35f numeric,
    c36h numeric,
    c36f numeric,
    c37h numeric,
    c37f numeric,
    c38h numeric,
    c38f numeric,
    c39 numeric,
    c40 numeric,
    c41a numeric,
    c41b numeric,
    c42a numeric,
    c42b numeric,
    c43a numeric,
    c43b numeric,
    c44a numeric,
    c44b numeric,
    c45a numeric,
    c45b numeric,
    c45c numeric,
    c46a numeric,
    c46b numeric,
    c47a numeric,
    c47b numeric,
    c48 numeric,
    c49 numeric,
    t101 numeric,
    t102 numeric,
    t103 numeric,
    t104 numeric,
    t105 numeric,
    t112 numeric,
    t113 numeric,
    t114 numeric,
    t121 numeric,
    t122 numeric,
    t123 numeric,
    t124 numeric,
    t125 numeric,
    t127 numeric,
    t128 numeric,
    t129 numeric,
    t130 numeric,
    t131 numeric,
    t132 numeric,
    t134 numeric,
    t135 numeric,
    t157 numeric,
    t158 numeric,
    t159 numeric,
    t160 numeric,
    t161 numeric,
    t167 numeric,
    t169 numeric,
    t175 numeric,
    t176 numeric,
    t177 numeric,
    t179 numeric,
    t182 numeric,
    t185 numeric,
    t106 numeric,
    t107 numeric,
    t108 numeric,
    t109 numeric,
    t110 numeric,
    t111 numeric,
    t115 numeric,
    t116 numeric,
    t117 numeric,
    t118 numeric,
    t119 numeric,
    t120 numeric,
    t126 numeric,
    t133 numeric,
    t136 numeric,
    t137 numeric,
    t138 numeric,
    t139 numeric,
    t140 numeric,
    t141 numeric,
    t142 numeric,
    t143 numeric,
    t144 numeric,
    t145 numeric,
    t146 numeric,
    t147 numeric,
    t148 numeric,
    t149 numeric,
    t150 numeric,
    t151 numeric,
    t152 numeric,
    t153 numeric,
    t154 numeric,
    t155 numeric,
    t156 numeric,
    t162 numeric,
    t163 numeric,
    t164 numeric,
    t165 numeric,
    t166 numeric,
    t168 numeric,
    t170 numeric,
    t171 numeric,
    t172 numeric,
    t173 numeric,
    t174 numeric,
    t178 numeric,
    t180 numeric,
    t181 numeric,
    t183 numeric,
    t184 numeric,
    t186 numeric,
    t187 numeric,
    t188 numeric,
    t189 numeric,
    t190 numeric,
    t191 numeric,
    t192 numeric,
    t193 numeric,
    t194 numeric,
    t195 numeric,
    t196 numeric,
    t197 numeric,
    t198 numeric,
    t199 numeric,
    t200 numeric,
    t201 numeric,
    t202 numeric,
    t203 numeric,
    p501a numeric,
    p501b integer,
    p502a numeric,
    p502b integer,
    p503a numeric,
    p503b integer,
    p504a numeric,
    p504b integer,
    p505a numeric,
    p505b integer,
    p506a numeric,
    p506b integer,
    p507a numeric,
    p507b integer,
    p508a numeric,
    p508b integer,
    p510a numeric,
    p510b integer,
    p511a numeric,
    p511b integer,
    p512a numeric,
    p512b integer,
    p521a numeric,
    p521b integer,
    p522a numeric,
    p522b integer,
    p523a numeric,
    p523b integer,
    p524a numeric,
    p524b integer,
    p538a numeric,
    p538b integer,
    p539a numeric,
    p539b integer,
    p546a numeric,
    p546b integer,
    p548a numeric,
    p548b integer,
    p549a numeric,
    p549b integer,
    p550a numeric,
    p550b integer,
    p551a numeric,
    p551b integer,
    p572a numeric,
    p572b integer,
    pnl509 numeric,
    pnn509 numeric,
    pnl513 numeric,
    pnn513 numeric,
    pnl514 numeric,
    pnn514 numeric,
    pnl515 numeric,
    pnn515 numeric,
    pnl516 numeric,
    pnn516 numeric,
    pnl517 numeric,
    pnn517 numeric,
    pnl518 numeric,
    pnn518 numeric,
    pnl519 numeric,
    pnn519 numeric,
    pnl520 numeric,
    pnn520 numeric,
    pnl525 numeric,
    pnn525 numeric,
    pnl526 numeric,
    pnn526 numeric,
    pnl527 numeric,
    pnn527 numeric,
    pnl528 numeric,
    pnn528 numeric,
    pnl529 numeric,
    pnn529 numeric,
    pnl530 numeric,
    pnn530 numeric,
    pnl531 numeric,
    pnn531 numeric,
    pnl532 numeric,
    pnn532 numeric,
    pnl533 numeric,
    pnn533 numeric,
    pnl534 numeric,
    pnn534 numeric,
    pnl535 numeric,
    pnn535 numeric,
    pnl536 numeric,
    pnn536 numeric,
    pnl537 numeric,
    pnn537 numeric,
    pnl540 numeric,
    pnn540 numeric,
    pnl541 numeric,
    pnn541 numeric,
    pnl542 numeric,
    pnn542 numeric,
    pnl543 numeric,
    pnn543 numeric,
    pnl544 numeric,
    pnn544 numeric,
    pnl545 numeric,
    pnn545 numeric,
    pnl547 numeric,
    pnn547 numeric,
    pnl552 numeric,
    pnn552 numeric,
    pnl553 numeric,
    pnn553 numeric,
    pnl554 numeric,
    pnn554 numeric,
    pnl555 numeric,
    pnn555 numeric,
    pnl556 numeric,
    pnn556 numeric,
    pnl557 numeric,
    pnn557 numeric,
    pnl559 numeric,
    pnn559 numeric,
    pnl560 numeric,
    pnn560 numeric,
    pnl561 numeric,
    pnn561 numeric,
    pnl562 numeric,
    pnn562 numeric,
    pnl563 numeric,
    pnn563 numeric,
    pnl564 numeric,
    pnn564 numeric,
    pnl565 numeric,
    pnn565 numeric,
    pnl566 numeric,
    pnn566 numeric,
    pnl567 numeric,
    pnn567 numeric,
    pnl568 numeric,
    pnn568 numeric,
    pnl569 numeric,
    pnn569 numeric,
    pnl570 numeric,
    pnn570 numeric,
    pnl571 numeric,
    pnn571 numeric,
    pnl573 numeric,
    pnn573 numeric,
    pnl574 numeric,
    pnn574 numeric,
    pnl575 numeric,
    pnn575 numeric,
    pnl577 numeric,
    pnn577 numeric,
    pnl579 numeric,
    pnn579 numeric,
    pnl580 numeric,
    pnn580 numeric,
    pnl581 numeric,
    pnn581 numeric,
    pnl582 numeric,
    pnn582 numeric,
    pnl584 numeric,
    pnn584 numeric,
    pnl585 numeric,
    pnn585 numeric,
    constraint agragated_pk primary key (geocode, rmo)
);
alter table agregateds owner to agritracking;
create index geo_codes_agregated on agregateds (geocode);